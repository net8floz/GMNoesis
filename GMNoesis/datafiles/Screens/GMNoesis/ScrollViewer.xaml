  <ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
  xmlns:noesis="clr-namespace:NoesisGUIExtensions"
  xmlns:g="clr-namespace:GMNoesis">

  <!-- ScrollBar -->
  <Style x:Key="Style.ScrollBar.Thumb" TargetType="Thumb">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="Thumb">
          <Grid Background="Transparent">
            <Border x:Name="Thumb" Background="{DynamicResource Brush.Thumb.Normal}" Margin="5" CornerRadius="3"/>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="Tag" Value="H">
              <Setter Property="Margin" Value="0,5" TargetName="Thumb"/>
            </Trigger>
            <Trigger Property="Tag" Value="V">
              <Setter Property="Margin" Value="5,0" TargetName="Thumb"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter Property="Background" Value="{DynamicResource Brush.Thumb.Over}" TargetName="Thumb"/>
            </Trigger>
            <Trigger Property="IsDragging" Value="True">
              <Setter Property="Background" Value="{DynamicResource Brush.Thumb.Pressed}" TargetName="Thumb"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter Property="Background" Value="{DynamicResource Brush.Thumb.Disabled}" TargetName="Thumb"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="Style.ScrollBar.LineButton" TargetType="RepeatButton" BasedOn="{StaticResource {x:Type RepeatButton}}">
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="ClickMode" Value="Press"/>
    <Setter Property="Delay" Value="250"/>
    <Setter Property="Interval" Value="100"/>
    <Setter Property="Width" Value="{DynamicResource Size.ScrollBar}"/>
    <Setter Property="Height" Value="{DynamicResource Size.ScrollBar}"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="RepeatButton">
          <Border x:Name="Border" Background="Transparent">
            <Path x:Name="Arrow" Data="{TemplateBinding Content}" Stroke="{DynamicResource Brush.Glyph.Normal}" StrokeThickness="1.5" HorizontalAlignment="Center" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5"/>
          </Border>
          <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
              <Setter Property="Stroke" Value="{DynamicResource Brush.Glyph.Over}" TargetName="Arrow"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
              <Setter Property="Stroke" Value="{DynamicResource Brush.Glyph.Over}" TargetName="Arrow"/>
              <Setter Property="RenderTransform" TargetName="Arrow">
                <Setter.Value>
                  <ScaleTransform ScaleX="0.9" ScaleY="0.9"/>
                </Setter.Value>
              </Setter>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
              <Setter Property="Stroke" Value="{DynamicResource Brush.Glyph.Disabled}" TargetName="Arrow"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <Style x:Key="Style.ScrollBar.PageButton" TargetType="RepeatButton" BasedOn="{StaticResource {x:Type RepeatButton}}">
    <Setter Property="IsTabStop" Value="False"/>
    <Setter Property="Focusable" Value="False"/>
    <Setter Property="ClickMode" Value="Press"/>
    <Setter Property="Delay" Value="250"/>
    <Setter Property="Interval" Value="100"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="RepeatButton">
          <Border Background="Transparent"/>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
  <ControlTemplate x:Key="Template.ScrollBar.Horizontal" TargetType="ScrollBar">
    <ControlTemplate.Resources>
      <Geometry x:Key="Geometry.LeftArrow">M4,0L0,4 4,8</Geometry>
      <Geometry x:Key="Geometry.RightArrow">M0,0 L4,4 0,8</Geometry>
    </ControlTemplate.Resources>
    <Grid x:Name="TemplateRoot" Background="Transparent">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      <Border x:Name="Background" Grid.ColumnSpan="3" Background="{DynamicResource Brush.Track.Normal}" Opacity="1"/>
      <RepeatButton x:Name="LineLeftButton" Grid.Column="0" Command="ScrollBar.LineLeftCommand" Style="{StaticResource Style.ScrollBar.LineButton}" Content="{StaticResource Geometry.LeftArrow}" Opacity="1"/>
      <RepeatButton x:Name="LineRightButton" Grid.Column="2" Command="ScrollBar.LineRightCommand" Style="{StaticResource Style.ScrollBar.LineButton}" Content="{StaticResource Geometry.RightArrow}" Opacity="1"/>
      <Track x:Name="PART_Track" Grid.Column="1" Orientation="Horizontal">
        <Track.DecreaseRepeatButton>
          <RepeatButton x:Name="PageLeftButton" Command="ScrollBar.PageLeftCommand" Style="{StaticResource Style.ScrollBar.PageButton}"/>
        </Track.DecreaseRepeatButton>
        <Track.IncreaseRepeatButton>
          <RepeatButton x:Name="IncreaseButton" Command="ScrollBar.PageRightCommand" Style="{StaticResource Style.ScrollBar.PageButton}"/>
        </Track.IncreaseRepeatButton>
        <Track.Thumb>
          <Thumb x:Name="Thumb" Style="{StaticResource Style.ScrollBar.Thumb}" Tag="H"  RenderTransformOrigin="0,0.8">
          </Thumb>
        </Track.Thumb>
      </Track>
    </Grid>
  </ControlTemplate>
  <ControlTemplate x:Key="Template.ScrollBar.Vertical" TargetType="ScrollBar">
    <ControlTemplate.Resources>
      <Geometry x:Key="Geometry.UpArrow">M0,4L4,0 8,4</Geometry>
      <Geometry x:Key="Geometry.DownArrow">M0,0 L4,4 8,0</Geometry>
    </ControlTemplate.Resources>
    <Grid x:Name="TemplateRoot" Background="Transparent">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>
      <Border x:Name="Background" Grid.RowSpan="3" Background="{DynamicResource Brush.Track.Normal}" Opacity="1"/>
      <RepeatButton x:Name="LineUpButton" Grid.Row="0" Command="ScrollBar.LineUpCommand" Style="{StaticResource Style.ScrollBar.LineButton}" Content="{StaticResource Geometry.UpArrow}" Opacity="1"/>
      <RepeatButton x:Name="LineDownButton" Grid.Row="2" Command="ScrollBar.LineDownCommand" Style="{StaticResource Style.ScrollBar.LineButton}" Content="{StaticResource Geometry.DownArrow}" Opacity="1"/>
      <Track x:Name="PART_Track" Grid.Row="1" Orientation="Vertical" IsDirectionReversed="True">
        <Track.DecreaseRepeatButton>
          <RepeatButton x:Name="PageUpButton" Command="ScrollBar.PageUpCommand" Style="{StaticResource Style.ScrollBar.PageButton}"/>
        </Track.DecreaseRepeatButton>
        <Track.IncreaseRepeatButton>
          <RepeatButton x:Name="IncreaseButton" Command="ScrollBar.PageDownCommand" Style="{StaticResource Style.ScrollBar.PageButton}"/>
        </Track.IncreaseRepeatButton>
        <Track.Thumb>
          <Thumb x:Name="Thumb" Style="{StaticResource Style.ScrollBar.Thumb}" Tag="V" RenderTransformOrigin="0.8,0">
          </Thumb>
        </Track.Thumb>
      </Track>
    </Grid>

  </ControlTemplate>
  <Style TargetType="ScrollBar">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="ForceCursor" Value="True"/>
    <Setter Property="Cursor" Value="Arrow"/>
    <Style.Triggers>
      <Trigger Property="Orientation" Value="Horizontal">
        <Setter Property="Height" Value="{DynamicResource Size.ScrollBar}"/>
        <Setter Property="MinHeight" Value="{DynamicResource Size.ScrollBar}"/>
        <Setter Property="Template" Value="{StaticResource Template.ScrollBar.Horizontal}"/>
      </Trigger>
      <Trigger Property="Orientation" Value="Vertical">
        <Setter Property="Width" Value="{DynamicResource Size.ScrollBar}"/>
        <Setter Property="MinWidth" Value="{DynamicResource Size.ScrollBar}"/>
        <Setter Property="Template" Value="{StaticResource Template.ScrollBar.Vertical}"/>
      </Trigger>
    </Style.Triggers>
  </Style>

  <!-- ScrollViewer -->
  <ControlTemplate x:Key="Template.ScrollViewer" TargetType="ScrollViewer">
    <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="{DynamicResource Corner.Border0}">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Decorator x:Name="ShowBarsRef" IsEnabled="true"/>
        <ScrollContentPresenter Grid.RowSpan="2" Grid.ColumnSpan="2" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}" CanContentScroll="{TemplateBinding CanContentScroll}" Margin="{TemplateBinding Padding}"/>
        <Rectangle x:Name="Corner" Grid.Row="1" Grid.Column="1" Fill="{DynamicResource Brush.Track.Normal}" IsEnabled="False" Opacity="1"/>
        <ScrollBar x:Name="PART_HorizontalScrollBar" Grid.Column="0" Grid.Row="1" Orientation="Horizontal" MaxHeight="{TemplateBinding MinHeight}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportWidth}" Minimum="0" Maximum="{TemplateBinding ScrollableWidth}" Opacity="1"/>
        <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0" Orientation="Vertical" MaxWidth="{TemplateBinding MinWidth}" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportHeight}" Minimum="0" Maximum="{TemplateBinding ScrollableHeight}" Opacity="1"/>
      </Grid>
    </Border>

    <ControlTemplate.Triggers>
      <Trigger Property="IsKeyboardFocusWithin" Value="True">
        <Setter Property="IsEnabled" Value="True" TargetName="ShowBarsRef"/>
      </Trigger>
      <Trigger Property="IsMouseOver" Value="True">
        <Setter Property="IsEnabled" Value="True" TargetName="ShowBarsRef"/>
      </Trigger>

      <Trigger Property="IsMouseOver" Value="True" SourceName="PART_HorizontalScrollBar">
        <Setter Property="IsEnabled" Value="True" TargetName="Corner"/>
      </Trigger>
      <Trigger Property="IsMouseOver" Value="True" SourceName="PART_VerticalScrollBar">
        <Setter Property="IsEnabled" Value="True" TargetName="Corner"/>
      </Trigger>

    </ControlTemplate.Triggers>
    
  </ControlTemplate>
  <Style TargetType="ScrollViewer" BasedOn="{StaticResource {x:Type ContentControl}}">
    <Setter Property="OverridesDefaultStyle" Value="True"/>
    <Setter Property="Background" Value="Transparent"/>
    <Setter Property="PanningMode" Value="Both"/>
    <Setter Property="Template" Value="{StaticResource Template.ScrollViewer}"/>
    <Setter Property="FocusVisualStyle" Value="{StaticResource Style.Focus.Outer.Uniform}"/>
  </Style>
</ResourceDictionary>